
DESCRIPTION >
    Store LLM events with usage metrics, costs, and metadata

SCHEMA >
    `timestamp` DateTime `json:$.start_time`,
    `end_time` DateTime `json:$.end_time`,
    `response_time` Float32 `json:$.standard_logging_object_response_time` DEFAULT 0,
    
    `response_status` LowCardinality(String) `json:$.standard_logging_object_status` DEFAULT 'unknown',
    `id` String `json:$.id` DEFAULT '',
    `environment` String `json:$.proxy_metadata.environment` DEFAULT '',

    `user` String `json:$.user` DEFAULT 'unknown',
    `referrer` String `json:$.referrer` DEFAULT 'unknown',

    `provider` LowCardinality(String) `json:$.provider` DEFAULT 'unknown',
    `model_requested` LowCardinality(String) `json:$.model_requested` DEFAULT 'unknown',
    `model_used` Nullable(String) `json:$.model_used`,
    `stream` Bool `json:$.stream` DEFAULT false,

    `cost` Float64 `json:$.cost` DEFAULT 0,

    `token_price_prompt_text` Float64 `json:$.token_price_prompt_text` DEFAULT 0,
    `token_price_prompt_audio` Float64 `json:$.token_price_prompt_audio` DEFAULT 0,
    `token_price_prompt_cached` Float64 `json:$.token_price_prompt_cached` DEFAULT 0,
    `token_price_completion_text` Float64 `json:$.token_price_completion_text` DEFAULT 0,
    `token_price_completion_audio` Float64 `json:$.token_price_completion_audio` DEFAULT 0,

    `token_count_prompt_text` UInt32 `json:$.token_count_prompt_text` DEFAULT 0,
    `token_count_prompt_audio` UInt32 `json:$.token_count_prompt_audio` DEFAULT 0,
    `token_count_prompt_cached` UInt32 `json:$.token_count_prompt_cached` DEFAULT 0,
    `token_count_completion_text` UInt32 `json:$.token_count_completion_text` DEFAULT 0,
    `token_count_completion_audio` UInt32 `json:$.token_count_completion_audio` DEFAULT 0,


ENGINE "MergeTree" 
ENGINE_PARTITION_KEY "toYYYYMM(timestamp)"
ENGINE_SORTING_KEY "timestamp, environment, user"
ENGINE_PRIMARY_KEY "timestamp, environment, user"

FORWARD_QUERY > 
  SELECT timestamp, end_time, response_time, response_status, id, environment, user, referrer, provider, model_requested, model_used, stream, cost, token_price_prompt_text, token_price_prompt_audio, token_price_prompt_cached, token_price_completion_text, token_price_completion_audio, token_count_prompt_text, token_count_prompt_audio, token_count_prompt_cached, token_count_completion_text, token_count_completion_audio
